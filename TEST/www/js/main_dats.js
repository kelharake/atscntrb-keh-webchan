/*
**
** The JavaScript code is generated by atscc2js
** The starting compilation time is: 2017-2-12: 11h:56m
**
*/

/* ATSextcode_beg() */

function channel_send_ws(obj, v) {
  obj.ws.send(v)
}


function console_log(str) {
  console.log(str);
}

function webchanjs_create(addr, fn) {
  var obj = {
    ws: null,
    cbs: [],
    messages: [],
    waiting: null
  };
  var ws = new WebSocket(addr);
  obj.ws = ws;
  ws.onmessage = function(x) {
    if (obj.cbs.length == 0) {
      obj.messages.push(x);
    } else {
      var f = obj.cbs.shift();
      f(x);
    }
  };
  ws.onopen = function() { fn(obj); };
}


function channel_receive_ws_int_cb(obj, f) {
  if (obj.messages.length == 0) {
    obj.cbs.push(function(x) { f(parseInt(x.data)); });
  } else {
    var msg = obj.messages.pop();
    f(parseInt(msg.data));
  }
}

function channel_receive_ws_int(obj) {
  while (obj.messages.length == 0);
  var msg = obj.messages.pop();
  return parseInt(msg.data);
}

function prompt_int(msg, v) {
  return parseInt(prompt(msg, v));
}

/* ATSextcode_end() */

/* ATSextcode_beg() */

init();

/* ATSextcode_end() */

function
worker_3(arg0)
{
//
// knd = 0
  var tmp4
  var tmp8
  var tmplab, tmplab_js
//
  // __patsflab_worker_3
  tmp4 = prompt_int("Enter a number:", 0);
  _057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_SATS_057_webchan_056_sats__channel_send__1__1(arg0, tmp4);
  alert("message sent!");
  tmp8 = prompt_int("Enter another number:", 0);
  _057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_SATS_057_webchan_056_sats__channel_send__1__2(arg0, tmp8);
  alert("message sent!");
  _057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__channel_receive_cb__2__1(arg0, __patsfun_7);
  // ATSINSmove_void
  return/*_void*/;
} // end-of-function


function
_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_SATS_057_webchan_056_sats__channel_send__1__1(arg0, arg1)
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab_channel_send
  channel_send_ws(arg0, arg1);
  return/*_void*/;
} // end-of-function


function
_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_SATS_057_webchan_056_sats__channel_send__1__2(arg0, arg1)
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab_channel_send
  channel_send_ws(arg0, arg1);
  return/*_void*/;
} // end-of-function


function
_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__channel_receive_cb__2__1(arg0, arg1)
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab_channel_receive_cb
  channel_receive_ws_int_cb(arg0, arg1);
  return/*_void*/;
} // end-of-function


function
__patsfun_7(arg0)
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab___patsfun_7
  alert(arg0);
  return/*_void*/;
} // end-of-function


function
init()
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // __patsflab_init
  webchanjs_create("ws://localhost:5000/", worker_3);
  return/*_void*/;
} // end-of-function


function
_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__dynload()
{
//
// knd = 0
  var tmplab, tmplab_js
//
  // ATSdynload()
  // ATSdynloadflag_ext(_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__dynloadflag(50))
  if(ATSCKiseqz(_057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__dynloadflag)) {
    _057_home_057_unknown_057_world_057_courses_057_myatscontrib_057_node_modules_057_atscntrb_055_keh_055_webchan_057_TEST_057_www_057_js_057_main_056_dats__dynloadflag = 1 ; // flag is set
  } // endif
  return/*_void*/;
} // end-of-function


/* ****** ****** */

/* end-of-compilation-unit */
